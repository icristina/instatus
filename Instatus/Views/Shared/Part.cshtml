@model WebPart

@if (Model is WebStream)
{
    var stream = (WebStream)Model;
    
    @Html.Action("Index", "Stream", stream.Query.ToRouteValueDictionary()
        .AddRequestParams()
        .AddNonEmptyValue("viewName", stream.ViewName)
        .AddNonEmptyValue("area", "Microsite"))
}
else if (Model is WebPartial)
{
    var webPartial = (WebPartial)Model;

    if (webPartial.ActionName.IsEmpty())
    {
        var webPartialContext = new WebPartialContext(Url, Html);
        var webPartialModel = webPartial.GetModel(webPartialContext);

        if (webPartialModel is MvcHtmlString)
        {
            @webPartialModel
        } 
        else if (webPartialModel is ViewDataDictionary) 
        {
            @Html.Partial(webPartial.ViewName, webPartialModel as ViewDataDictionary)            
        }
        else 
        {
            @Html.Partial(webPartial.ViewName, webPartialModel)            
        }        
    }
    else
    {
        var routeValues = new RouteValueDictionary() {
            { "viewName", webPartial.ViewName },
            { "controller", "home" },
            { "area", "" }    
        };
        
        foreach(var param in webPartial.Parameters) {
            routeValues.AddNonEmptyValue(param.Name, param.Content);
        }
        
        @Html.Action(webPartial.ActionName, routeValues)
    }
} 
else if (Model is WebSection)
{
    var webSection = (WebSection)Model;
    
    @Html.Partial(webSection.ViewName ?? "Section", webSection)
}